<% include partials/header %>


  
<div class="container containerProfile">
        <div class="card">
                <div class="card-body">
                        <div class="row">
                                <div class="col-3">
                                        <img src="<%= user.image %>" 
                                        alt="... " 
                                        onerror=this.src='https://www.searchpng.com/wp-content/uploads/2019/02/Deafult-Profile-Pitcher.png'
                                        class="img-thumbnail img-fluid profilePic">
                                </div>
                                <div class="col-9">
                                        <% if(!(user._id.equals(userId))){ %>
                                                <%if(following){ %>
                                                        <form action="/unfollow/<%=user._id%>" method="POST">
                                                                <button class="btn btn-primary float-right">Following</button>
                                                        </form>
                                                <% }else{ %>
                                                        <form action="/follow/<%=user._id%>" method="POST">
                                                                <button class="btn btn-outline-primary float-right">Follow</button>
                                                        </form>  
                                                <% } %>     
                                        <% } %>
                                        <h4 class="card-title"><%= user.fname%> <%= user.lname%></h4>
                                        <h5 class="card-subtitle mb-2 text-muted">
                                                <%= user.username%>
                                        </h5>
                                        <p class="card-text txtPadding">Engineer by Education, Entrepreneur by Profession, Nano-Science Researcher by Interest, YouTuber by Passion... (link: http://youtube.com/TechnicalGuruji) youtube.com/TechnicalGuruji Your Daily Tech Dose!!</p>
                                        <p class="card-text text-muted txtPadding">
                                                <i class="fas fa-map-marker-alt"></i> <%=user.address%>
                                        </p>
                                        <p class="card-text text-muted txtPadding">
                                                <i class="fas fa-birthday-cake"></i>
                                                <% if(user.dob){ %>
                                                        <%=moment(user.dob).format('MMMM Do YYYY'); %>
                                               <% } %>
                                        </p>
                                        <p class="card-text text-muted txtPadding">
                                                <i class="far fa-envelope"></i> <%=user.email%>
                                        </p>
                                        <p>
                                                <strong>205</strong> Following <strong>55</strong> Followers
                                                <% if(user._id.equals(userId)){ %>
                                                        <a href="/profile/<%=user.username%>/edit" 
                                                        class="btn btn-info float-right">Update Profile</a>
                                                <% }%>
                                        </p>
                                        
                                </div>
                        </div> 
                </div>
        </div>
        <div class="container" id="homePageContainer">
                <% if(user._id.equals(userId)){ %>
                        <div class="card mt-2">
                                        <div class="card-header">
                                                        Create Post
                                        </div>
                                <div class="card-body">
                                       
                                        <form action="/post" method="POST" id="postForm" enctype="">
                                                <!-- enctype="multipart/form-data"(toggle in index.js) -->
                                                <div class="form-group">
                                                        <textarea name="text" rows="3" class="form-control" placeholder="Write something here ......"></textarea>
                                                </div>
                                                <div class="row">
                                                        <div class="col-10">
                                                                <div class="form-group">
                                                                        <label for="image">Image</label>
                                                                        <input type="file" class="form-control-file " id="image" name="image" accept="image/*">
                                                                </div>
                                                        </div>
                                                        <div class="col-2 postBtnpadding">       
                                                                <button class="btn btn-primary float-right " id="postbtn">Post</button>
                                                        </div>
                                                </div>
                                        </form>
                                </div>
                        </div>
                <% } %>

                <h6 class="mt-2 mb-0">Posts:</h6>
                <br>
                <% for(let i=user.posts.length-1; i>=0; i--){ %>
                        <div class="card">
                        <div class="card-body">
                                <h5>
                                        <a  class="card-title link" 
                                        href="/profile/<%=user.posts[i].author.username%>"><img src="<%= user.image %>" class="img-thumbnail rounded-circle postImg" 
                                        onerror=this.src='https://www.searchpng.com/wp-content/uploads/2019/02/Deafult-Profile-Pitcher.png'> <%=user.posts[i].author.username %></a> 
                                </h5>
                                <p class="card-text"><%= user.posts[i].text %></p>
                                
                        </div>
                        <%if(user.posts[i].image!==""){ %>
                                <img src="<%= user.posts[i].image %>" class="card-img-top" alt="...">
                        <%} %>
                        <div class="card-body pb-0">
                                <% var status=false;   %>
                                <% for(let l of user.posts[i].likes){   %>
                                <%  if(l==userId){  %>
                                        <%  status=true;  %>
                                        <%  break; %>
                                <% } %>
                                <% }  %>
                                <%  if(status){  %>
                                <a href="/post/<%= user.posts[i]._id%>/unlike" class="likeBtn"><i class="fas fa-heart fa-2x"></i></a>
                                <a href="/post/<%= user.posts[i]._id%>/comments"><i class="far fa-comment-alt fa-2x"></i></a>
                                <p class="count"><span><%= user.posts[i].likes.length %></span> likes</p>
                                <%  }else{  %>
                                <a href="/post/<%= user.posts[i]._id%>/like" class="likeBtn"><i class="far fa-heart fa-2x"></i></a>
                                <a href="/post/<%= user.posts[i]._id%>/comments"><i class="far fa-comment-alt fa-2x"></i></a>
                                <p class="count"><span><%= user.posts[i].likes.length %></span> likes</p>
                                <%  } %>
                        </div>   
                        </div>
                        <br>
                <%} %>
        </div>
</div>

<% include partials/footer %>